(load "/Users/blake/Dropbox (MIT)/Classes/6.945/Final_Project/Schemer/modified-eval-apply/code/load")


(define orig-apply apply)

(define (apply procedure arguments calling-environment)
;  (display "(\n")
  (display (cons procedure (map (lambda (arg) (eval arg calling-environment)) arguments)))
;  (display ")\n")
  (display "\n")
  (orig-apply procedure arguments calling-environment))

(define orig-eval eval)

(define (eval expression environment)
;  (display expression)
;  (display (orig-eval expression environment))
;  (display "\n")
  (orig-eval expression environment))



(init)

eval> (define (fact n)
  (if (< n 2) 
      1
      (* (fact (- n 1)) n)))
fact

eval> (fact 5)
(#[compound-procedure 50] 5)
(#[arity-dispatched-procedure 27 <] 5 2)
(#[arity-dispatched-procedure 28 -] 5 1)
(#[compound-procedure 50] 4)
(#[arity-dispatched-procedure 28 -] 5 1)
(#[arity-dispatched-procedure 27 <] 4 2)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[compound-procedure 50] 3)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[arity-dispatched-procedure 27 <] 3 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 2 3)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 6 4)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[compound-procedure 50] 3)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[arity-dispatched-procedure 27 <] 3 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 2 3)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 24 5)
(#[arity-dispatched-procedure 28 -] 5 1)
(#[compound-procedure 50] 4)
(#[arity-dispatched-procedure 28 -] 5 1)
(#[arity-dispatched-procedure 27 <] 4 2)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[compound-procedure 50] 3)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[arity-dispatched-procedure 27 <] 3 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 2 3)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 6 4)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[compound-procedure 50] 3)
(#[arity-dispatched-procedure 28 -] 4 1)
(#[arity-dispatched-procedure 27 <] 3 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 2 3)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[compound-procedure 50] 2)
(#[arity-dispatched-procedure 28 -] 3 1)
(#[arity-dispatched-procedure 27 <] 2 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
(#[arity-dispatched-procedure 20 *] 1 2)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[compound-procedure 50] 1)
(#[arity-dispatched-procedure 28 -] 2 1)
(#[arity-dispatched-procedure 27 <] 1 2)
120
